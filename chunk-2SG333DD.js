import{a as ne}from"./chunk-Q2BCXKMV.js";import{a as ie}from"./chunk-G534ZD6B.js";import"./chunk-G2EXQAOB.js";import{$ as z,C as S,F as N,L as E,P as Q,S as j,V as M,X as V,Z as $,_ as G,ba as J,c as g,ca as I,d as _,da as K,e as m,ea as U,f as h,fa as W,g as c,ga as O,h as w,i as C,j as b,ja as X,k as v,ka as T,l as R,la as Y,m as L,ma as Z,n as D,na as P,o as x,oa as ee,p as t,q as i,qa as y,r as k,s as u,t as d,ta as te,u as l,v as a,va as H,w as q,x as F,y as A}from"./chunk-OZ3HA5LS.js";import"./chunk-LJMIX235.js";import"./chunk-4FL3BPNC.js";import"./chunk-CBEOSJTC.js";import"./chunk-HVK7QFVP.js";import"./chunk-5JIQGJOD.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as f}from"./chunk-2R6CW7ES.js";var se=()=>[0,1];function le(e,o){if(e&1){let r=u();t(0,"div",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-title")(5,"ion-label",2),a(6,"Est\xE0s segur que vols tancar la sessi\xF3?"),i()()()(),t(7,"ion-row")(8,"ion-col")(9,"ion-button",3),d("click",function(){_(r);let n=l();return n.logout(),m(n.requestLogoutModal())}),a(10,"S\xED"),i()()(),t(11,"ion-row")(12,"ion-col")(13,"ion-button",4),d("click",function(){_(r);let n=l();return m(n.requestLogoutModal())}),a(14,"No"),i()()()()()}}var oe=(()=>{let o=class o{constructor(){this._sessionService=g(H),this._router=g(E),this.isLogoutModalOpen=this._sessionService.logoutRequested}ngOnInit(){}logout(){return f(this,null,function*(){yield this._sessionService.logout(),this._router.navigate(["/login"])})}requestLogoutModal(){this._sessionService.setLogoutRequest()}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=w({type:o,selectors:[["app-logout-modal"]],decls:2,vars:4,consts:[[3,"isOpen","initialBreakpoint","breakpoints"],[1,"modal-div"],[1,"ion-text-wrap"],["expand","block","color","success",3,"click"],["expand","block","color","danger",3,"click"]],template:function(n,p){n&1&&(t(0,"ion-modal",0),C(1,le,15,0,"ng-template"),i()),n&2&&x("isOpen",p.isLogoutModalOpen())("initialBreakpoint",1)("breakpoints",S(3,se))},dependencies:[O,P,I,y,T,M,V],styles:["ion-modal[_ngcontent-%COMP%]{--height: auto}.modal-div[_ngcontent-%COMP%]{background-color:var(--ion-color-tertiary-background)}"]});let e=o;return e})();var re=()=>[0,1];function ce(e,o){if(e&1&&(t(0,"ion-item")(1,"p"),a(2),i()()),e&2){let r=o.$implicit,s=o.$index;c(2),A("Codi visitant ",s+1,": ",r)}}function de(e,o){if(e&1){let r=u();t(0,"ion-button",9),d("click",function(){_(r);let n=l(2);return m(n.onShowVisits())}),a(1,"Tancar identificadors visitants"),i(),t(2,"ion-list")(3,"ion-list-header")(4,"ion-label"),a(5," Visitants des de l'\xFAltim inici de sessi\xF3 "),i()(),L(6,ce,3,2,"ion-item",null,R),i()}if(e&2){let r=l(2);c(6),D(r.readBarcodes())}}function _e(e,o){if(e&1){let r=u();t(0,"ion-button",9),d("click",function(){_(r);let n=l(2);return m(n.onShowVisits())}),t(1,"ion-text"),a(2," Veure identificadors visitants "),t(3,"span",3),a(4,"(*)"),i()()()}}function me(e,o){if(e&1&&b(0,de,8,0)(1,_e,5,0,"ion-button",8),e&2){let r=l();v(r.showVisits()?0:1)}}function pe(e,o){if(e&1){let r=u();t(0,"div",10)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-title")(5,"ion-label"),a(6),i()()()(),t(7,"ion-row")(8,"ion-col")(9,"ion-button",11),d("click",function(){_(r);let n=l();return m(n.onAddVisit())}),a(10,"Anotar visitant"),i()()(),t(11,"ion-row")(12,"ion-col")(13,"ion-button",12),d("click",function(){_(r);let n=l();return m(n.onIgnoreVisit())}),a(14,"Ignorar"),i()()()()()}if(e&2){let r=l();c(6),F("Entrada ",r.lastBarcode())}}function ue(e,o){e&1&&(t(0,"ion-label"),a(1,"Error de sessi\xF3"),i())}function ge(e,o){e&1&&(t(0,"ion-label"),a(1,"Error de servidor"),i())}function fe(e,o){if(e&1){let r=u();t(0,"ion-row")(1,"ion-col")(2,"ion-button",12),d("click",function(){_(r);let n=l(2);return m(n.onResetSession())}),a(3,"Reiniciar sessi\xF3"),i()()()}}function xe(e,o){if(e&1){let r=u();t(0,"ion-row")(1,"ion-col")(2,"ion-button",11),d("click",function(){_(r);let n=l(2);return m(n.onAddVisit())}),a(3,"Tornar-ho a provar"),i()()(),t(4,"ion-row")(5,"ion-col")(6,"ion-button",12),d("click",function(){_(r);let n=l(2);return m(n.onIgnoreVisit())}),a(7,"Cancel\xB7lar"),i()()()}}function Ce(e,o){if(e&1&&(t(0,"div",10)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-title"),b(5,ue,2,0,"ion-label")(6,ge,2,0,"ion-label"),i()()(),b(7,fe,4,0,"ion-row")(8,xe,8,0),i()()),e&2){let r=l();c(5),v(r.sessionError()?5:6),c(2),v(r.sessionError()?7:8)}}var Re=(()=>{let o=class o{constructor(){this._router=g(E),this._barcodeScannerService=g(ie),this._sessionService=g(H),this.showVisits=h(!1),this.lastBarcode=this._barcodeScannerService.lastBarcode,this.readBarcodes=this._barcodeScannerService.readBarcodes,this.user=this._sessionService.user,this.nvisits=this._barcodeScannerService.nvisits,this.sessionError=this._barcodeScannerService.sessionError,this.serverError=this._barcodeScannerService.serverError,this.isVisitModalOpen=h(!1),this.isErrorModalOpen=h(!1)}ngOnInit(){}onScanQR(){return f(this,null,function*(){yield this._barcodeScannerService.scanQR(),this.isVisitModalOpen.set(!0)})}onShowVisits(){this.showVisits.update(s=>!s)}onAddVisit(){return f(this,null,function*(){yield this._barcodeScannerService.addVisit(),this.isVisitModalOpen.set(!1),this.isErrorModalOpen.set(!1),this.sessionError()||this.serverError()?this.isErrorModalOpen.set(!0):(this.isErrorModalOpen.set(!1),this.onScanQR())})}onIgnoreVisit(){this.isVisitModalOpen.set(!1),this.isErrorModalOpen.set(!1),this.onScanQR()}onResetSession(){return f(this,null,function*(){this.isErrorModalOpen.set(!1),yield this._sessionService.logout(),this._router.navigate(["/login"])})}};o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=w({type:o,selectors:[["app-home"]],decls:34,vars:12,consts:[["color","main-background",3,"fullscreen"],[1,"content"],["color","tertiary-background"],[1,"clarification"],[3,"isOpen","initialBreakpoint","breakpoints"],["slot","fixed","vertical","top","horizontal","end"],["color","secondary-background",3,"click"],["name","scan"],["expand","block","color","secondary-background"],["expand","block","color","secondary-background",3,"click"],[1,"modal-div"],["expand","block","color","success",3,"click"],["expand","block","color","danger",3,"click"]],template:function(n,p){if(n&1&&(k(0,"app-header"),t(1,"ion-content",0)(2,"div",1)(3,"ion-card",2)(4,"ion-card-header")(5,"ion-card-title"),a(6),i()(),t(7,"ion-card-content")(8,"ion-grid")(9,"ion-row")(10,"ion-col")(11,"p"),a(12),t(13,"span",3),a(14,"(*)"),i()()()(),t(15,"ion-row")(16,"ion-col"),b(17,me,2,1),i()(),t(18,"ion-row")(19,"ion-col")(20,"ion-text")(21,"p",3),a(22,"(*) Dades "),t(23,"span"),a(24,"locals"),i(),a(25," des de l'\xFAltim inici de sessi\xF3"),i()()()()()()()(),t(26,"ion-modal",4),C(27,pe,15,1,"ng-template"),i(),t(28,"ion-modal",4),C(29,Ce,9,2,"ng-template"),i(),t(30,"ion-fab",5)(31,"ion-fab-button",6),d("click",function(){return p.onScanQR()}),k(32,"ion-icon",7),i()(),k(33,"app-logout-modal"),i()),n&2){let B;c(),x("fullscreen",!0),c(5),q((B=p.user())==null?null:B.family),c(6),F("Nombre de visitants escanejats: ",p.nvisits()," "),c(5),v(p.readBarcodes().length>0?17:-1),c(9),x("isOpen",p.isVisitModalOpen())("initialBreakpoint",1)("breakpoints",S(10,re)),c(2),x("isOpen",p.isErrorModalOpen())("initialBreakpoint",1)("breakpoints",S(11,re))}},dependencies:[ne,K,$,z,J,G,O,I,P,U,W,te,V,Y,X,Z,T,y,M,ee,N,j,Q,oe],styles:["ion-fab[_ngcontent-%COMP%]{padding-top:4px;padding-right:4px}ion-modal[_ngcontent-%COMP%]{--height: auto}.modal-div[_ngcontent-%COMP%]{background-color:var(--ion-color-tertiary-background)}p.clarification[_ngcontent-%COMP%], p[_ngcontent-%COMP%]   span.clarification[_ngcontent-%COMP%]{font-style:italic;color:var(--ion-color-secondary-background)}span.clarification[_ngcontent-%COMP%]{font-style:italic}.clarification[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}"]});let e=o;return e})();export{Re as HomePage};
