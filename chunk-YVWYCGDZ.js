import{b as ne}from"./chunk-GOOGFLQ2.js";import{a as ie}from"./chunk-NOPQMNWC.js";import"./chunk-G2EXQAOB.js";import{A as P,Aa as te,B as E,C as T,G as V,J as y,Q as H,U as B,X as F,_ as R,aa as A,ca as D,da as Q,ea as N,g as C,ga as L,h as _,ha as $,i as m,ia as j,j as b,ja as z,k as l,ka as G,l as k,la as q,m as v,n as g,o as x,oa as J,p as M,pa as K,q as I,qa as U,r as O,ra as W,s as S,sa as X,t,ta as Y,u as i,v as w,va as Z,w as u,x as d,y as c,ya as ee,z as o}from"./chunk-SQZI5EJA.js";import"./chunk-LJMIX235.js";import"./chunk-4FL3BPNC.js";import"./chunk-CBEOSJTC.js";import"./chunk-HVK7QFVP.js";import"./chunk-5JIQGJOD.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as f}from"./chunk-2R6CW7ES.js";var oe=()=>[0,1];function re(e,r){if(e&1&&(t(0,"ion-item")(1,"p"),o(2),i()()),e&2){let n=r.$implicit,s=r.$index;l(2),T("Codi visitant ",s+1,": ",n)}}function ae(e,r){if(e&1){let n=u();t(0,"ion-button",9),d("click",function(){_(n);let a=c(2);return m(a.onShowVisits())}),o(1,"Tancar identificadors visitants"),i(),t(2,"ion-list")(3,"ion-list-header")(4,"ion-label"),o(5," Visitants des de l'\xFAltim inici de sessi\xF3 "),i()(),I(6,re,3,2,"ion-item",null,M),i()}if(e&2){let n=c(2);l(6),O(n.readBarcodes())}}function se(e,r){if(e&1){let n=u();t(0,"ion-button",9),d("click",function(){_(n);let a=c(2);return m(a.onShowVisits())}),t(1,"ion-text"),o(2," Veure identificadors visitants "),t(3,"span",3),o(4,"(*)"),i()()()}}function le(e,r){if(e&1&&g(0,ae,8,0)(1,se,5,0,"ion-button",8),e&2){let n=c();x(n.showVisits()?0:1)}}function ce(e,r){if(e&1){let n=u();t(0,"div",10)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-title")(5,"ion-label"),o(6),i()()()(),t(7,"ion-row")(8,"ion-col")(9,"ion-button",11),d("click",function(){_(n);let a=c();return m(a.onAddVisit())}),o(10,"Anotar visitant"),i()()(),t(11,"ion-row")(12,"ion-col")(13,"ion-button",12),d("click",function(){_(n);let a=c();return m(a.onIgnoreVisit())}),o(14,"Ignorar"),i()()()()()}if(e&2){let n=c();l(6),E("Entrada ",n.lastBarcode())}}function de(e,r){e&1&&(t(0,"ion-label"),o(1,"Error de sessi\xF3"),i())}function _e(e,r){e&1&&(t(0,"ion-label"),o(1,"Error de servidor"),i())}function me(e,r){if(e&1){let n=u();t(0,"ion-row")(1,"ion-col")(2,"ion-button",12),d("click",function(){_(n);let a=c(2);return m(a.onResetSession())}),o(3,"Reiniciar sessi\xF3"),i()()()}}function pe(e,r){if(e&1){let n=u();t(0,"ion-row")(1,"ion-col")(2,"ion-button",11),d("click",function(){_(n);let a=c(2);return m(a.onAddVisit())}),o(3,"Tornar-ho a provar"),i()()(),t(4,"ion-row")(5,"ion-col")(6,"ion-button",12),d("click",function(){_(n);let a=c(2);return m(a.onIgnoreVisit())}),o(7,"Cancel\xB7lar"),i()()()}}function ue(e,r){if(e&1&&(t(0,"div",10)(1,"ion-grid")(2,"ion-row")(3,"ion-col")(4,"ion-title"),g(5,de,2,0,"ion-label")(6,_e,2,0,"ion-label"),i()()(),g(7,me,4,0,"ion-row")(8,pe,8,0),i()()),e&2){let n=c();l(5),x(n.sessionError()?5:6),l(2),x(n.sessionError()?7:8)}}var Ve=(()=>{let r=class r{constructor(){this._router=C(H),this._barcodeScannerService=C(ie),this._sessionService=C(te),this.showVisits=b(!1),this.lastBarcode=this._barcodeScannerService.lastBarcode,this.readBarcodes=this._barcodeScannerService.readBarcodes,this.user=this._sessionService.user,this.nvisits=this._barcodeScannerService.nvisits,this.sessionError=this._barcodeScannerService.sessionError,this.serverError=this._barcodeScannerService.serverError,this.isVisitModalOpen=b(!1),this.isErrorModalOpen=b(!1)}ngOnInit(){}onScanQR(){return f(this,null,function*(){yield this._barcodeScannerService.scanQR(),this.isVisitModalOpen.set(!0)})}onShowVisits(){this.showVisits.update(s=>!s)}onAddVisit(){return f(this,null,function*(){yield this._barcodeScannerService.addVisit(),this.isVisitModalOpen.set(!1),this.isErrorModalOpen.set(!1),this.sessionError()||this.serverError()?this.isErrorModalOpen.set(!0):(this.isErrorModalOpen.set(!1),this.onScanQR())})}onIgnoreVisit(){this.isVisitModalOpen.set(!1),this.isErrorModalOpen.set(!1),this.onScanQR()}onResetSession(){return f(this,null,function*(){this.isErrorModalOpen.set(!1),yield this._sessionService.logout(),this._router.navigate(["/login"])})}};r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=k({type:r,selectors:[["app-home"]],decls:33,vars:12,consts:[["color","main-background",3,"fullscreen"],[1,"content"],["color","tertiary-background"],[1,"clarification"],[3,"isOpen","initialBreakpoint","breakpoints"],["slot","fixed","vertical","top","horizontal","end"],["color","secondary-background",3,"click"],["name","scan"],["expand","block","color","secondary-background"],["expand","block","color","secondary-background",3,"click"],[1,"modal-div"],["expand","block","color","success",3,"click"],["expand","block","color","danger",3,"click"]],template:function(a,p){if(a&1&&(w(0,"app-header"),t(1,"ion-content",0)(2,"div",1)(3,"ion-card",2)(4,"ion-card-header")(5,"ion-card-title"),o(6),i()(),t(7,"ion-card-content")(8,"ion-grid")(9,"ion-row")(10,"ion-col")(11,"p"),o(12),t(13,"span",3),o(14,"(*)"),i()()()(),t(15,"ion-row")(16,"ion-col"),g(17,le,2,1),i()(),t(18,"ion-row")(19,"ion-col")(20,"ion-text")(21,"p",3),o(22,"(*) Dades "),t(23,"span"),o(24,"locals"),i(),o(25," des de l'\xFAltim inici de sessi\xF3"),i()()()()()()()(),t(26,"ion-modal",4),v(27,ce,15,1,"ng-template"),i(),t(28,"ion-modal",4),v(29,ue,9,2,"ng-template"),i(),t(30,"ion-fab",5)(31,"ion-fab-button",6),d("click",function(){return p.onScanQR()}),w(32,"ion-icon",7),i()()()),a&2){let h;l(),S("fullscreen",!0),l(5),P((h=p.user())==null?null:h.family),l(6),E("Nombre de visitants escanejats: ",p.nvisits()," "),l(5),x(p.readBarcodes().length>0?17:-1),l(9),S("isOpen",p.isVisitModalOpen())("initialBreakpoint",1)("breakpoints",V(10,oe)),l(2),S("isOpen",p.isErrorModalOpen())("initialBreakpoint",1)("breakpoints",V(11,oe))}},dependencies:[ne,j,D,N,L,Q,q,$,X,z,G,ee,A,U,J,W,K,Z,R,Y,y,F,B],styles:["ion-fab[_ngcontent-%COMP%]{padding-top:4px;padding-right:4px}ion-modal[_ngcontent-%COMP%]{--height: auto}.modal-div[_ngcontent-%COMP%]{background-color:var(--ion-color-tertiary-background)}.modal-div[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{padding-bottom:50px}p.clarification[_ngcontent-%COMP%], p[_ngcontent-%COMP%]   span.clarification[_ngcontent-%COMP%]{font-style:italic;color:var(--ion-color-secondary-background)}span.clarification[_ngcontent-%COMP%]{font-style:italic}.clarification[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}"]});let e=r;return e})();export{Ve as HomePage};
